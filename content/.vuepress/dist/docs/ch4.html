<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab 4: Using Particle Webhooks with ThingSpeak | Particle Accelerate Workshop</title>
    <meta name="description" content="Workshops designed to teach the basics of IoT development with the Particle ecosystem &amp; the Particle Argon">
    
    
    <link rel="preload" href="/assets/css/7.styles.c68e7648.css" as="style"><link rel="preload" href="/assets/js/app.a5ac3454.js" as="script"><link rel="preload" href="/assets/js/1.bf344b8f.js" as="script"><link rel="prefetch" href="/assets/js/0.b8a0d595.js"><link rel="prefetch" href="/assets/js/2.18440fcd.js"><link rel="prefetch" href="/assets/js/3.fa2cdf50.js"><link rel="prefetch" href="/assets/js/4.bb15e6d7.js"><link rel="prefetch" href="/assets/js/5.886b4d3b.js"><link rel="prefetch" href="/assets/js/6.def3e71f.js">
    <link rel="stylesheet" href="/assets/css/7.styles.c68e7648.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Particle Accelerate Workshop
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://particle.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Team
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><a href="https://github.com/particle-iot/spectra-workshop-2020" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://particle.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Team
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><a href="https://github.com/particle-iot/spectra-workshop-2020" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><a href="/docs/" class="sidebar-link">About Particle Workshops</a></li><li><a href="/docs/ch1.html" class="sidebar-link">Lab 1: Getting your Particle Argon online</a></li><li><a href="/docs/ch2.html" class="sidebar-link">Lab 2: Working with Particle Workbench &amp; Primitives</a></li><li><a href="/docs/ch3.html" class="sidebar-link">Lab 3: Exploring BLE &amp; Advanced Device OS Features</a></li><li><a href="/docs/ch4.html" class="active sidebar-link">Lab 4: Exploring Particle SDKs &amp; Integrations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/ch4.html#introducing-particle-integrations-and-thingspeak" class="sidebar-link">Introducing Particle Integrations and ThingSpeak</a></li><li class="sidebar-sub-header"><a href="/docs/ch4.html#visualizing-sensor-data-with-thingspeak-and-matlab" class="sidebar-link">Visualizing Sensor Data with ThingSpeak and MATLAB</a></li></ul></li><li><a href="/docs/extra.html" class="sidebar-link">Extra: Going Even Further!</a></li></ul></div><div class="page"><div class="content"><h1 id="lab-4-using-particle-webhooks-with-thingspeak"><a href="#lab-4-using-particle-webhooks-with-thingspeak" aria-hidden="true" class="header-anchor">#</a> Lab 4: Using Particle Webhooks with ThingSpeak</h1><table><thead><tr><th><strong>Project Goal</strong></th><th>Use Particle Webhooks and Integrations to connect your app to ThingSpeak; B uilding dashboards in  ThingSpeak.</th></tr></thead><tbody><tr><td><strong>What you’ll learn</strong></td><td>Working with Particle Integrations and ThingSpeak</td></tr><tr><td><strong>Tools you’ll need</strong></td><td>Particle Workbench, a <a href="https://thingspeak.com/users/sign_up" target="_blank" rel="noopener noreferrer">ThingSpeak<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> account, a Particle Argon, and the IoT Starter Kit, a Particle Debugger.</td></tr><tr><td><strong>Time needed to complete</strong></td><td>60 minutes</td></tr></tbody></table><p>In this session, you're going to explore the power of Particle integrations with the popular ThingSpeak service, then build dashboards with ThingSpeak to visualize sensor data. If you get stuck at any point during this session, <a href="https://go.particle.io/shared_apps/5e5ebc3b81620d0022ad4e96" target="_blank" rel="noopener noreferrer">click here for the completed, working source of the firmware changes you'll make in this lab<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><h2 id="introducing-particle-integrations-and-thingspeak"><a href="#introducing-particle-integrations-and-thingspeak" aria-hidden="true" class="header-anchor">#</a> Introducing Particle Integrations and ThingSpeak</h2><p>Before we set up an integration with ThingSpeak, we need to send data from our devices to the Particle Device Cloud.</p><h3 id="publishing-a-payload-with-temp-and-humidity-values"><a href="#publishing-a-payload-with-temp-and-humidity-values" aria-hidden="true" class="header-anchor">#</a> Publishing a payload with temp and humidity values</h3><p>Let's send the current temp, humidity and light level using a <code>Particle.publish</code> event. You'll sind a single event with all three values in a single JSON object. To do this, you'll use the <code>JSONParserGenerator</code> library.</p><ol><li><p>Open the Workbench Command Palette (CMD+SHIFT+P or CTRL+SHIFT+P) and select the &quot;Particle: Install Library&quot; option.</p></li><li><p>In the text box, type &quot;JsonParserGeneratorRK&quot; and click enter.</p></li><li><p>At the top of your project, add an include statement:</p></li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;JsonParserGeneratorRK.h&quot;</span></span>
</code></pre></div><ol start="4"><li>Add a new function to your app called <code>createEventPayload</code> that takes the temp, humidity and light readings. This function will create an instance of <code>JsonWriterStatic</code> and <code>JsonWriterAutoObject</code> objects, insert key-value pairs for each reading, and then get the JSON object as a string buffer that you can send along in a <code>Particle.publish()</code> event.</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">createEventPayload</span><span class="token punctuation">(</span><span class="token keyword">int</span> temp<span class="token punctuation">,</span> <span class="token keyword">int</span> humidity<span class="token punctuation">,</span> <span class="token keyword">double</span> light<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  JsonWriterStatic<span class="token operator">&lt;</span><span class="token number">256</span><span class="token operator">&gt;</span> jw<span class="token punctuation">;</span>
  <span class="token punctuation">{</span>
    JsonWriterAutoObject <span class="token function">obj</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>jw<span class="token punctuation">)</span><span class="token punctuation">;</span>

    jw<span class="token punctuation">.</span><span class="token function">insertKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;temp&quot;</span><span class="token punctuation">,</span> temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    jw<span class="token punctuation">.</span><span class="token function">insertKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;humidity&quot;</span><span class="token punctuation">,</span> humidity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    jw<span class="token punctuation">.</span><span class="token function">insertKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span> light<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>Now, let's publish a new event, and call the <code>createEventPayload</code> function to provide a formatted JSON string for the data parameter. Add the following to the end of your <code>createEventPayload</code> function.</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code>Particle<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&quot;env-vals&quot;</span><span class="token punctuation">,</span> jw<span class="token punctuation">.</span><span class="token function">getBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PRIVATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="6"><li>Finally, your <code>loop</code> function, call the <code>createEventPayload</code> function you just created.</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token function">createEventPayload</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> humidity<span class="token punctuation">,</span> currentLightLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="7"><li>Flash this firmware to your device and navigate to the Particle console. Every few seconds, you'll see a new <code>env-vals</code> event show up.</li></ol><p><img src="/assets/img/env-vals.003cdde5.png" alt></p><p>Now you're ready to set-up an integration.</p><h3 id="setting-up-a-thingspeak-app"><a href="#setting-up-a-thingspeak-app" aria-hidden="true" class="header-anchor">#</a> Setting up a ThingSpeak App</h3><ol><li>If you haven't already done so, create a <a href="https://thingspeak.com/users/sign_up" target="_blank" rel="noopener noreferrer">free ThingSpeak account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ol><p><img src="/assets/img/thingspeak.21c43e7a.png" alt></p><ol start="2"><li>Once you've logged into your ThingSpeak account, navigate to the Channels tab and click &quot;New Channel.&quot;</li></ol><p><img src="/assets/img/ts-channel.a8a2ba37.png" alt></p><ol start="3"><li>On the &quot;New Channel&quot; screen, add a name and desciption, and the values &quot;temp&quot;, &quot;humidity&quot;, and &quot;light&quot; in the first three fields. Set the Metadata field to &quot;JSON&quot; and click &quot;Save Channel.&quot;</li></ol><p><img src="/assets/img/ts-channel-config.c50054fd.png" alt></p><ol start="4"><li>After you save, your channel dashboard will load, showing three charts and no values. Let's get those populated with your sensor data!</li></ol><p><img src="/assets/img/ts-dashboard.717d2190.png" alt></p><h3 id="creating-the-webhook-to-publish-to-thingspeak"><a href="#creating-the-webhook-to-publish-to-thingspeak" aria-hidden="true" class="header-anchor">#</a> Creating the Webhook to Publish to ThingSpeak</h3><ol><li>In the ThingSpeak dashboard for your channel, click on the &quot;API Keys&quot; tab and copy your Write API Key. You'll need that to set up your webhook.</li></ol><p><img src="/assets/img/ts-keys.90e0070f.png" alt></p><ol start="2"><li>Head back to the <a href="https://console.particle.io" target="_blank" rel="noopener noreferrer">Particle Console<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and click on the Integrations menu on the left nav.</li></ol><p><img src="/assets/img/console-integrations.02ce322e.png" alt></p><ol start="3"><li>Click the &quot;New Integration&quot; Card.</li></ol><p><img src="data:image/png;base64,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" alt></p><ol start="4"><li>Click the &quot;Webhook&quot; Menu item.</li></ol><p><img src="/assets/img/webhook.2c5f7a43.png" alt></p><ol start="5"><li>In the Webhook builder, enter the name &quot;env-vals&quot; for the name (or whatever event name you chose in your firmware if you decided to be a maverick and do your own thing). For the URL, enter &quot;https://api.thingspeak.com/update.&quot; Keep the request type as <code>POST</code> and change the Request Format to &quot;Web Form&quot;. Select the name of your device from the Device drop-down.</li></ol><p><img src="/assets/img/webhook-props.8da66dd0.png" alt></p><ol start="6"><li>Before saving, click &quot;Advanced Settings&quot; and the &quot;Custom&quot; option under form fields. Add four fields:</li></ol><ul><li>api_key &gt; &quot;Write API Key from ThingSpeak&quot;</li><li>field1 &gt; {{{<code>temp</code>}}}</li><li>field2 &gt; {{{<code>humidity</code>}}}</li><li>field3 &gt; {{{<code>light</code>}}}</li></ul><p><img src="/assets/img/webhook-advanced.f07caf65.png" alt></p><ol start="7"><li>Now Save. Wait a few seconds and refresh the page. Then, scroll to the bottom to confirm that events are being captured and sent sucessfully.</li></ol><p><img src="/assets/img/events.4a9f9709.png" alt></p><h2 id="visualizing-sensor-data-with-thingspeak-and-matlab"><a href="#visualizing-sensor-data-with-thingspeak-and-matlab" aria-hidden="true" class="header-anchor">#</a> Visualizing Sensor Data with ThingSpeak and MATLAB</h2><p>Navigate back to your ThingSpeak channel and you should see the default charts update as data streams in from your device.</p><p><img src="/assets/img/ts-events.6745b0e6.png" alt></p><p>Let's customize these charts, add a few more, and explore creating advanced visualizations in MATLAB.</p><h3 id="customizing-field-widgets"><a href="#customizing-field-widgets" aria-hidden="true" class="header-anchor">#</a> Customizing Field Widgets</h3><ol><li>Click on the pencil icon on the top of &quot;Field 1 Chat&quot; to open the chart options window.</li></ol><p><img src="/assets/img/ts-pencil.9cfe978c.png" alt></p><ol start="2"><li>Set the title as &quot;Temperature&quot;, the color as &quot;#00aeef,&quot; the type to &quot;spline&quot; and click Save.</li></ol><p><img src="/assets/img/ts-customize.88c75ad7.png" alt></p><ol start="3"><li>Repeat the process with the other charts and behold the Cyan goodness!</li></ol><p><img src="/assets/img/ts-cyancharts.c79f3223.png" alt></p><h3 id="adding-widgets"><a href="#adding-widgets" aria-hidden="true" class="header-anchor">#</a> Adding Widgets</h3><p>Now let's add a new widget to show the current temperature on a Gauge.</p><ol><li>On the Channel dashboard, click the &quot;Add Widget&quot; button.</li></ol><p><img src="/assets/img/ts-add-widget.0a7fcdc4.png" alt></p><ol start="2"><li>Click the Gauge card, then click next.</li></ol><p><img src="/assets/img/ts-create-gauge.bf9ca0e8.png" alt></p><ol start="3"><li>In the widget parameters screen, modify the values to correspond to the image below.</li></ol><p><img src="/assets/img/ts-gauge-options.71cd1e29.png" alt></p><ol start="4"><li>Click save and your gauge should now be on screen, with the latest reading. It will also change as new data comes in.</li></ol><p><img src="/assets/img/ts-gauge.59b8e992.png" alt></p><h3 id="creating-advanced-visualizations-in-matlab"><a href="#creating-advanced-visualizations-in-matlab" aria-hidden="true" class="header-anchor">#</a> Creating Advanced Visualizations in MATLAB</h3><p>Finally, let's use ThingSpeak's built-in support for MATLAB to create a basic histogram showing correlation between temperature and humidity data.</p><ol><li>On the Channel dashboard, click the &quot;MATLAB Visualization&quot; button.</li></ol><p><img src="/assets/img/ts-add-matlab.3bc79b66.png" alt></p><ol start="2"><li>Under the examples section, click the &quot;Visualize correlation between temperature and humidity.&quot;</li></ol><p><img src="/assets/img/ts-viz.bc1f5d4f.png" alt></p><ol start="3"><li>In the MATLAB Code window that loads in the next screen, you'll need to change a few values including the <code>readChannelID</code>, the <code>TemperatureFieldID</code>, <code>HumidityFieldID</code>, <code>readAPIKey</code> and the integer value next to <code>NumPoints</code> on line 23. We've included the final code here, with a few placeholders you should change for your own channel and key values.</li></ol><div class="language-Matlab extra-class"><pre class="language-matlab"><code>readChannelID <span class="token operator">=</span> <span class="token operator">&lt;</span>your<span class="token operator">-</span>channel<span class="token operator">-</span>id<span class="token operator">&gt;</span><span class="token punctuation">;</span> 
TemperatureFieldID <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
HumidityFieldID <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> 

<span class="token comment">% CHANGE KEY BELOW %</span>
readAPIKey <span class="token operator">=</span> <span class="token string">'&lt;read api key&gt;'</span><span class="token punctuation">;</span> 

<span class="token comment">% Change the default NumPoints of 300 to 100 %</span>
data <span class="token operator">=</span> <span class="token function">thingSpeakRead</span><span class="token punctuation">(</span>readChannelID<span class="token punctuation">,</span><span class="token string">'Fields'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>TemperatureFieldID HumidityFieldID<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
                                               <span class="token string">'NumPoints'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
                                               <span class="token string">'ReadKey'</span><span class="token punctuation">,</span>readAPIKey<span class="token punctuation">)</span><span class="token punctuation">;</span> 

temperatureData <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
humidityData <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Visualize the data</span>
<span class="token function">scatter</span><span class="token punctuation">(</span>temperatureData<span class="token punctuation">,</span>humidityData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Temperature'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Humidity'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><ol start="4"><li>Once you've adapted the code accordingly, click &quot;Save and Run.&quot; You'll see a scatter plot show-up in the output, and this new visualization will show up on your Channel dashboard as well!</li></ol><p><img src="/assets/img/ts-run-viz.2fa6f299.png" alt></p><hr><p><strong>Congratulations! You've completed this workshop. Now you're a Particle Master! Take a moment to pat yourself on the back and bask in your newfound IoT-commandery. And if you want to take your exploration further, click the &quot;Extra&quot; link below!</strong></p><p><strong>BEFORE YOU GO</strong> you'd love it if you could provide feedback on this workshop. Please visit <a href="https://particleiot.typeform.com/to/JiF8xM" target="_blank" rel="noopener noreferrer">this link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to rate your experience.</p></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/particle-iot/spectra-workshop-2020/edit/master/content/docs/ch4.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/ch3.html" class="prev">
          Lab 3: Exploring BLE &amp; Advanced Device OS Features
        </a></span><span class="next"><a href="/docs/extra.html">
          Extra: Going Even Further!
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/1.bf344b8f.js" defer></script><script src="/assets/js/app.a5ac3454.js" defer></script>
  </body>
</html>
