<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 3: Using Particle Webhooks with IFTTT, and exploring on-device debugging | Particle Accelerate Workshop</title>
    <meta name="description" content="Workshops designed to teach the basics of IoT development with the Particle ecosystem &amp; the Particle Argon">
    
    
    <link rel="preload" href="/assets/css/6.styles.b7d182e7.css" as="style"><link rel="preload" href="/assets/js/app.7315a9e1.js" as="script"><link rel="preload" href="/assets/js/1.b85082d9.js" as="script"><link rel="prefetch" href="/assets/js/0.e77bbc49.js"><link rel="prefetch" href="/assets/js/2.ddc02673.js"><link rel="prefetch" href="/assets/js/3.9ab7d8d9.js"><link rel="prefetch" href="/assets/js/4.b3f3c945.js"><link rel="prefetch" href="/assets/js/5.fcc0370a.js">
    <link rel="stylesheet" href="/assets/css/6.styles.b7d182e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Particle Accelerate Workshop
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://particle.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Team
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><a href="https://github.com/particle-iot/roadshow-workshop-2019" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://particle.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Team
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><a href="https://github.com/particle-iot/roadshow-workshop-2019" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><a href="/docs/" class="sidebar-link">About Particle Workshops</a></li><li><a href="/docs/ch1.html" class="sidebar-link">Chapter 1: Getting your Particle Argon online</a></li><li><a href="/docs/ch2.html" class="sidebar-link">Chapter 2: Working with Particle Workbench, primitives &amp; BLE</a></li><li><a href="/docs/ch3.html" class="active sidebar-link">Chapter 3: On-Device Debugging and integrations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/ch3.html#exploring-the-particle-cli-and-device-cloud-api" class="sidebar-link">Exploring the Particle CLI and Device Cloud API</a></li><li class="sidebar-sub-header"><a href="/docs/ch3.html#introducing-the-particle-integrations-and-ifttt" class="sidebar-link">Introducing the Particle Integrations and IFTTT</a></li><li class="sidebar-sub-header"><a href="/docs/ch3.html#on-device-debugging-with-workbench" class="sidebar-link">On-Device Debugging with Workbench</a></li></ul></li><li><a href="/docs/extra.html" class="sidebar-link">Extra: Going Even Further!</a></li></ul></div><div class="page"><div class="content"><h1 id="chapter-3-using-particle-webhooks-with-ifttt-and-exploring-on-device-debugging"><a href="#chapter-3-using-particle-webhooks-with-ifttt-and-exploring-on-device-debugging" aria-hidden="true" class="header-anchor">#</a> Chapter 3: Using Particle Webhooks with IFTTT, and exploring on-device debugging</h1><table><thead><tr><th><strong>Project Goal</strong></th><th>Use Particle Webhooks and Integrations to connect your app to IFTTT; Learn to perform on-device debugging in Particle Workbench.</th></tr></thead><tbody><tr><td><strong>What you’ll learn</strong></td><td>Working with Particle Integrations, IFTTT, and on-devie debugging in Particle Workbench</td></tr><tr><td><strong>Tools you’ll need</strong></td><td>Particle Workbench, an <a href="https://ifttt.com" target="_blank" rel="noopener noreferrer">IFTTT.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> account, a Particle Argon, and the Grove Starter Kit for Particle Mesh, a Particle Debugger.</td></tr><tr><td><strong>Time needed to complete</strong></td><td>60 minutes</td></tr></tbody></table><p>In this session, you're going to explore the power of Particle integrations with the popular IF This Then That (IFTTT) service, then explore using Particle Workbench to perform on-device debugging. If you get stuck at any point during this session, <a href="https://go.particle.io/shared_apps/5d40aec2279e1e000b9ad57b" target="_blank" rel="noopener noreferrer">click here for the completed, working source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p>First, let's take a brief look at the Particle CLI and Device Cloud API.</p><h2 id="exploring-the-particle-cli-and-device-cloud-api"><a href="#exploring-the-particle-cli-and-device-cloud-api" aria-hidden="true" class="header-anchor">#</a> Exploring the Particle CLI and Device Cloud API</h2><h3 id="the-particle-cli"><a href="#the-particle-cli" aria-hidden="true" class="header-anchor">#</a> The Particle CLI</h3><ol><li>If you haven't already, <a href="https://docs.particle.io/guide/tools-and-features/cli/photon/" target="_blank" rel="noopener noreferrer">install the Particle CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Open a terminal window and type the following command:</li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">bash</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span> <span class="token function">curl</span> -sL https://particle.io/install-cli <span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>Type <code>particle login</code> and enter your Particle account email and password when prompted.</li></ol><p><img src="/assets/img/particlelogin.14fc48ea.gif" alt></p><ol start="3"><li>Once you're logged in, type <code>particle list</code> to see your list of online devices.</li></ol><p><img src="/assets/img/particlelist.085a96a6.gif" alt></p><ol start="4"><li>The device you've been using for this workshop has two variables and one function. Get the value of the <code>temp</code> variable with the command <code>particle get temp</code>.</li></ol><p><img src="/assets/img/temp.61c682e4.gif" alt></p><ol start="5"><li>You can also call one of the two functions to light up the yellow or blue LED button. Type the command <code>particle call &lt;your-device-name&gt; toggleLed</code> in the terminal. Run the same command again to turn the light off.</li></ol><h3 id="the-particle-device-cloud-api"><a href="#the-particle-device-cloud-api" aria-hidden="true" class="header-anchor">#</a> The Particle Device Cloud API</h3><p>Behind the scenes, every interface that Particle provides to work with devices, from the Console, to mobile apps, SDKs, and the CLI, they all talk through a RESTful Device Cloud API. You can even call yourself, directly.</p><p><em>The next few steps assume you have cURL installed on your machine. If you don't have this command-line utility on your machine, you can download and install it <a href="https://curl.haxx.se/download.html" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or use a GUI-based tool like <a href="https://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Postman<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</em></p><ol><li><p>First, you'll need to obtain an access token from the CLI. Type <code>particle token list</code> to view the tokens associated with your account. The first one listed is your <code>user</code> token, and can be used to access the Device Cloud API. If no tokens are listed, generate a new one with <code>particle token new</code>.</p></li><li><p>With your token and Device ID in hand, type the following cURL command into a terminal window, replacing the text below in <code>&lt; &gt;</code> with your information.</p></li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://api.particle.io/v1/devices?access_token<span class="token operator">=</span><span class="token operator">&lt;</span>your token<span class="token operator">&gt;</span>
</code></pre></div><p>By default, the response will generate a wall of text in your terminal. If you have Python 2.6+ installed on your machine, you can pipe the output to the <code>json.tool</code> and get pretty-printed JSON.</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://api.particle.io/v1/devices\?access_token\<span class="token operator">=</span><span class="token operator">&lt;</span>your token<span class="token operator">&gt;</span>
<span class="token operator">|</span> python -m json.tool
</code></pre></div><p><img src="/assets/img/curllist.d0d65fc2.gif" alt></p><ol start="3"><li><p>For this next command, you need the Device ID of the Photon attached to your badge. You can find that in the console or via the <code>particle list</code> CLI command.</p></li><li><p>Let's call the <code>toggleLed</code> function using the Device Cloud API. Type the following, again replacing the text below in <code>&lt; &gt;</code> with your information.</p></li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://api.particle.io/v1/devices/<span class="token operator">&lt;</span>device id<span class="token operator">&gt;</span>/toggleB \
     -d access_token<span class="token operator">=</span><span class="token operator">&lt;</span>your token<span class="token operator">&gt;</span>
</code></pre></div><p><img src="/assets/img/curlcall.64f3b77c.gif" alt></p><p>You've now explored a number of ways that you can interface with the Particle Device cloud and your connected devices! Now, let's go beyond the Particle ecosystem and explore some of the ways that you can integrate with other 3rd party services, and backhaul your data into other cloud services.</p><h2 id="introducing-the-particle-integrations-and-ifttt"><a href="#introducing-the-particle-integrations-and-ifttt" aria-hidden="true" class="header-anchor">#</a> Introducing the Particle Integrations and IFTTT</h2><h3 id="setting-up-an-ifttt-integration"><a href="#setting-up-an-ifttt-integration" aria-hidden="true" class="header-anchor">#</a> Setting up an IFTTT Integration</h3><p>IFTTT (If This, Then That) is a web-based service that allows you to create integrations via simple conditional statements, called applets. There are hundreds of pre-built services you can leverage, and first-class support for Particle devices. In this section, you're going to create an IFTTT integration that posts a tweet when you press a button on your badge.</p><p><strong>Note</strong>: During the flow below, you'll need to connect both your Particle and Google accounts with IFTTT. When prompted, follow the on-screen instructions to do so.</p><ol><li>Start by heading over to <a href="https://ifttt.com/particle" target="_blank" rel="noopener noreferrer">IFTTT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and either login, or create a new account.</li></ol><p><img src="/assets/img/ifttt.87dd6306.png" alt></p><ol start="2"><li>After logging in, click your profile picture in the top right of your dashboard and select the &quot;Create&quot; menu option.</li></ol><p><img src="/assets/img/newapplet.f57ba0af.png" alt></p><ol start="3"><li>Click the &quot;+This&quot; button.</li></ol><p><img src="/assets/img/ifthis.477a2737.png" alt></p><ol start="4"><li>In the &quot;Search services&quot; input, type &quot;particle&quot; and click on the Particle card.</li></ol><p><img src="/assets/img/chooseservice.a4696eac.png" alt></p><p><img src="/assets/img/chooseparticle.17810c99.png" alt></p><ol start="5"><li>Click on the &quot;New event published&quot; card.</li></ol><p><img src="/assets/img/choosetrigger.7f3f2422.png" alt></p><ol start="6"><li>In the trigger fields, set the event name as <code>env-vals</code>, leave the Event Content field blank and set the Device name to the name of your device. Click &quot;create trigger.&quot;</li></ol><p><img src="/assets/img/triggerfields.f5d59af9.png" alt></p><ol start="7"><li>You've set-up the trigger on the Particle end, now its time for the <strong>That</strong>+ portion of the setup. Click the &quot;+That&quot; button.</li></ol><p><img src="/assets/img/thenthat.5c372b0e.png" alt></p><ol start="8"><li>In the &quot;Search services&quot; input, type &quot;Google Sheets&quot; and click on the Google Sheets card.</li></ol><p><img src="/assets/img/choose-gsheets.0db9b253.png" alt></p><ol start="9"><li>Click on the &quot;Add row to spreadsheet&quot; card.</li></ol><p><img src="/assets/img/addrow-card.f6f6177c.png" alt></p><ol start="10"><li>In the action fields, set the spreadsheet name to &quot;TCEnvVals.&quot; Leave the defaults in the other fields and click &quot;Create action.&quot;</li></ol><p><img src="/assets/img/ifttt-gsheets.0cf21597.png" alt></p><ol start="11"><li>Click the &quot;Finish&quot; button to create your applet.</li></ol><p><img src="/assets/img/ifttt-reviewpng.f1031ce7.png" alt></p><p><img src="/assets/img/ifttt-live.bcf9a351.png" alt></p><p>Now, let's modify our device firmware to publish temp and humidity values.</p><h3 id="publishing-a-payload-with-temp-and-humidity-values"><a href="#publishing-a-payload-with-temp-and-humidity-values" aria-hidden="true" class="header-anchor">#</a> Publishing a payload with temp and humidity values</h3><p>Now, let's send the current temp, humidity and light level using a <code>Particle.publish</code> event. You'll sind a single event with all three values in a single JSON object. To do this, you'll use the <code>JSONParserGenerator</code> library.</p><ol><li><p>Open the Workbench Command Palette (CMD+SHIFT+P or CTRL+SHIFT+P) and select the &quot;Particle: Install Library&quot; option.</p></li><li><p>In the text box, type &quot;JsonParserGeneratorRK&quot; and click enter.</p></li><li><p>At the top of your project, add an include statement:</p></li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;JsonParserGeneratorRK.h&quot;</span></span>
</code></pre></div><ol start="4"><li>Add a new function to your app called <code>createEventPayload</code> that takes the temp, humidity and light readings. This function will create an instance of <code>JsonWriterStatic</code> and <code>JsonWriterAutoObject</code> objects, insert key-value pairs for each reading, and then get the JSON object as a string buffer that you can send along in a <code>Particle.publish()</code> event.</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">createEventPayload</span><span class="token punctuation">(</span><span class="token keyword">int</span> temp<span class="token punctuation">,</span> <span class="token keyword">int</span> humidity<span class="token punctuation">,</span> <span class="token keyword">double</span> light<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  JsonWriterStatic<span class="token operator">&lt;</span><span class="token number">256</span><span class="token operator">&gt;</span> jw<span class="token punctuation">;</span>
  <span class="token punctuation">{</span>
    JsonWriterAutoObject <span class="token function">obj</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>jw<span class="token punctuation">)</span><span class="token punctuation">;</span>

    jw<span class="token punctuation">.</span><span class="token function">insertKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;temp&quot;</span><span class="token punctuation">,</span> temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    jw<span class="token punctuation">.</span><span class="token function">insertKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;humidity&quot;</span><span class="token punctuation">,</span> humidity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    jw<span class="token punctuation">.</span><span class="token function">insertKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span> light<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>Now, let's publish a new event, and call the <code>createEventPayload</code> function to provide a formatted JSON string for the data parameter. Add the following to the end of your <code>createEventPayload</code> function.</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code>Particle<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&quot;env-vals&quot;</span><span class="token punctuation">,</span> jw<span class="token punctuation">.</span><span class="token function">getBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PRIVATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="6"><li>Finally, your <code>loop</code> function, call the <code>createEventPayload</code> function you just created.</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token function">createEventPayload</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> humidity<span class="token punctuation">,</span> currentLightLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="posting-sensor-values-to-google-sheets"><a href="#posting-sensor-values-to-google-sheets" aria-hidden="true" class="header-anchor">#</a> Posting sensor values to Google Sheets</h3><ol><li>Flash this firmware to your device and navigate to the Particle console. Every few seconds, you'll see a new <code>env-vals</code> event show up.</li></ol><p><img src="/assets/img/env-vals.003cdde5.png" alt></p><ol start="2"><li>Open Google Drive and look for a folder named &quot;events.&quot; In that folder, you'll find a Sheet called &quot;TCEnvVals.&quot; Open it, and you'll see a row for each event published by your device:</li></ol><p><img src="/assets/img/gsheet.9e35275d.png" alt></p><p>Now that you have data streaming into Google Sheets, let's transform the data and create some simple visualizations!</p><h3 id="processing-data-in-google-sheets"><a href="#processing-data-in-google-sheets" aria-hidden="true" class="header-anchor">#</a> Processing data in Google Sheets</h3><p>Before you create data visualizations with our sensor data, you need to transform the sensor values into discrete values. You'll do this by creating a simple script that processes the raw data as it is added to the main sheet, inserting each raw sensor value in a new sheet for data viz.</p><ol><li><p>In the &quot;TCEnvVals&quot; document, create a new sheet called &quot;Processed&quot; and give it four columns, &quot;Temp,&quot; &quot;Humidity,&quot; &quot;Light&quot; and &quot;Time.&quot;</p></li><li><p>In the Tools menu, click the &quot;Script Editor&quot; option, which will open a new tab with the Google Apps Script editor.</p></li><li><p>Click on the &quot;Untitled project&quot; text and give the project a name, like &quot;ProcessTCSensorData.&quot;</p></li><li><p>Remove the default function code and add an <code>onChange</code> event with the following code.</p></li></ol><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> row <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">var</span> envVals <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span> <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> time <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span> <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">var</span> envObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>envVals<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>envObj<span class="token punctuation">.</span>temp <span class="token operator">!=</span> <span class="token string">'0'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> ss <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> processedSheet <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span><span class="token string">'Processed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    processedSheet<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span>envObj<span class="token punctuation">.</span>temp<span class="token punctuation">,</span> envObj<span class="token punctuation">.</span>humidity<span class="token punctuation">,</span> envObj<span class="token punctuation">.</span>light<span class="token punctuation">,</span> time<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The code above is a JavaScript function that uses the Google Sheets API to get the last row inserted into the main sheet, extract the sensor vals, and the timestamp. The sensor vals are parsed into a JSON object, and then you add a new row to the &quot;Processed&quot; sheet with those values and the timestamp.</p><ol start="5"><li><p>Save the file.</p></li><li><p>Now, you'll need to add a change trigger to this app. Click the clock icon to open the triggers for this project.</p></li></ol><p><img src="/assets/img/opentriggers.472d5e1f.png" alt></p><ol start="7"><li>Click &quot;Add Trigger&quot; at the bottom left.</li></ol><p><img src="/assets/img/addtrigger.35846ea3.png" alt></p><ol start="8"><li>In the trigger window that opens, make sure that <code>onChange</code> is selected as the function name, and &quot;On change&quot; is selected as the event type.</li></ol><p><img src="/assets/img/addtriggerwindow.e6e28097.png" alt></p><ol start="9"><li>Click save to create the trigger. You'll be asked to sign-in with your Google Account and grant access to your app. Follow the on-screen instructions to do so.</li></ol><p><img src="/assets/img/triggerlist.3a8799cb.png" alt></p><ol start="10"><li>In the tab for your spreadsheet, select the &quot;Processed&quot; sheet. After a few moments, records should start coming through.</li></ol><p><img src="/assets/img/processed.c7097725.png" alt></p><p>If you're not seeing anything after a bit, you can click the &quot;Check now&quot; button in your IFTTT Applet.</p><p><img src="/assets/img/checknow.d0cc9765.png" alt></p><h3 id="visualizing-data-with-google-sheets"><a href="#visualizing-data-with-google-sheets" aria-hidden="true" class="header-anchor">#</a> Visualizing data with Google Sheets</h3><p>Once you have some processed data, you can add a chart to your sheet!</p><ol><li><p>Create a new tab called &quot;DataViz&quot;</p></li><li><p>Click the &quot;Insert&quot; menu and select &quot;Chart.&quot;</p></li></ol><p><img src="/assets/img/chart.ee6b4164.png" alt></p><ol start="3"><li>The Chart menu will open on the right side of the window. In the &quot;Chart type&quot; drop-down, select the combination chart type.</li></ol><p><img src="/assets/img/combochart.5e75f031.png" alt></p><ol start="4"><li>Click the X-Axis box to open the &quot;Select a data range&quot; window. Navigate to the &quot;Processed&quot; sheet and select the top of the Time tab.</li></ol><p><img src="/assets/img/selectX.17f33cc7.gif" alt></p><ol start="5"><li>Click &quot;Add Series&quot; to open the &quot;Select a data range&quot; window.</li></ol><p><img src="/assets/img/addtemp.01caef9f.gif" alt></p><ol start="6"><li>Repeat the same process to add Series data for the &quot;Humidity&quot; and &quot;Light&quot; columns.</li></ol><p><img src="/assets/img/chartfilled.179a960f.png" alt></p><ol start="7"><li>Now let's customize. In the Chart editor, click the &quot;Customize&quot; tab and expand the &quot;Series&quot; item. Select the &quot;Temp&quot; series. Then, change the type to &quot;Line.&quot;</li></ol><p><img src="/assets/img/templine.5a0ac5c7.png" alt></p><ol start="8"><li>Now select the &quot;Light&quot; series and change the type to &quot;Columns.&quot;</li></ol><p><img src="/assets/img/lightline.ad8f851b.png" alt></p><ol start="9"><li>Close the chart editor. If everything has been configured properly, you'll see a chart that looks like this.</li></ol><p><img src="/assets/img/finalchart.6b347941.png" alt></p><p>And that's how you do DataViz with Google Sheets and IFTTT. Now performing on-device debugging with Particle Workbench.</p><h2 id="on-device-debugging-with-workbench"><a href="#on-device-debugging-with-workbench" aria-hidden="true" class="header-anchor">#</a> On-Device Debugging with Workbench</h2><p>So far in this workshop, we've used the USB Serial interface to inspect and debug the current state of our devices with <code>Serial.print()</code> statements. And while this approach is handy for quickly inspecting the state of a running application, Particle provides first-class on-device debugging support with Particle Workbench. In this section, we'll explore using Workbench to step-debug our Particle-powered app.</p><h3 id="prepare-for-debugging"><a href="#prepare-for-debugging" aria-hidden="true" class="header-anchor">#</a> Prepare for Debugging</h3><p>In order to perform step debugging and a few other features, you'll need to disable Mesh and BLE support in your application firmware. This is to address a current limitation in software that DeviceOS depends on to handle real-time networking and communication.</p><p>At the start of your <code>setup</code> function, add the following two lines to disable Mesh and BLE during debugging. The <code>#if</code> preprocessor ensures that these commands are only compiled into the binary if you're running a debug build.</p><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">if</span> defined(DEBUG_BUILD)</span>
Mesh<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
BLE<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
</code></pre></div><p>Now, continue onto the next step. When you flash a debug build to your device, you'll automatically disable Mesh and BLE so you can perform step debugging.</p><h3 id="connect-the-particle-debugger"><a href="#connect-the-particle-debugger" aria-hidden="true" class="header-anchor">#</a> Connect the Particle Debugger</h3><p>To complete this portion of the lab, you'll need the following:</p><ul><li>Particle Workbench</li><li>The trusty Argon you've been using for other parts of this lab</li><li>One <a href="https://store.particle.io/products/particle-debugger" target="_blank" rel="noopener noreferrer">Particle Debugger<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>A free USB port on your laptop</li></ul><p>Both the Debugger and the Particle device must be connected to the same computer via USB, so make sure you have enough ports available. If your laptop has only USB C ports available, ask a lab proctor for an adapter.</p><p>Connect the debugger to the debug port on your Particle device using the provided ribbon cable, and plug both into your computer. The debug port consists of ten exposed pins protected by some plastic, and you can find it next to the LiPo battery port near the top of the device.</p><p><img src="/assets/img/DebuggerCable.d4a3b0de.png" alt></p><h3 id="create-a-debug-firmware-binary"><a href="#create-a-debug-firmware-binary" aria-hidden="true" class="header-anchor">#</a> Create a debug firmware binary</h3><p>Once everything is connected and powered on, you’ll need to put your Particle device into Device Firmware Update (DFU) mode. In order for Workbench to facilitate on-device debugging, it needs to compile and flash a debug build of your application and the Particle Device OS firmware in a single binary. You’ll sometimes see this referred to as a “monolithic” build because this differs from the normal build process, where Device OS and your application firmware can be updated independent of one another.</p><ol><li>To put your device in DFU mode, press and hold the <code>MODE</code> and <code>RESET</code> buttons on the device. Then, release the <code>RESET</code> button, while continuing to hold the <code>MODE</code> button until the RGB LED on the device starts blinking yellow.</li></ol><p><img src="/assets/img/DFU.ca7c6a9d.gif" alt></p><ol start="2"><li><p>Now that you’re setup on the hardware side, let’s start a debugging session and cover some Workbench basics. Make sure your project from this workshop is open in Workbench. Click the &quot;bug&quot; icon in the VS Code / Workbench sidebar to open the debug sidebar.</p></li><li><p>Click the debug configurations dropdown and select the &quot;Particle debugger (argon, boron/bsom, xenon)&quot; option.</p></li></ol><p><img src="/assets/img/DebugMenu.50572ba2.png" alt></p><ol start="4"><li>Finally, click the green arrow next to the debug configuration dropdown to initiate the debug process.</li></ol><p><img src="/assets/img/GreenArrow.f7ec3a86.png" alt></p><p>Now, get ready to wait a bit as Workbench creates a debug binary for your project. This will go much faster on repeat runs, but the first run is a good time to grab a cup of coffee, take a stretch break, or <a href="https://xkcd.com/303/" target="_blank" rel="noopener noreferrer">practice your sword-fighting in the hallway<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><ol start="5"><li>Once the debug binary is built and flashed to your device, Workbench will halt and your device will power down, which you’ll see once the onboard RGB LED turns off. You’ll also see the following message in the Debug Console, which is expected.</li></ol><p><img src="/assets/img/DebugConsole.9effdd9b.png" alt></p><ol start="6"><li>Click the continue button to power your device back up. Once you’re breathing cyan again, you’re ready to debug!</li></ol><p><img src="/assets/img/ContinueButton.3ee70174.png" alt></p><h3 id="step-debug-your-device-with-workbench"><a href="#step-debug-your-device-with-workbench" aria-hidden="true" class="header-anchor">#</a> Step-debug your device with Workbench</h3><h4 id="setting-breakpoints-and-stepping-through-code"><a href="#setting-breakpoints-and-stepping-through-code" aria-hidden="true" class="header-anchor">#</a> Setting breakpoints and stepping through code</h4><ol><li><p>Let's start with one of the most commonly-used debug features: setting breakpoints. This allows you to pause and inspect the state of running code during execution. You can set breakpoints by clicking in the gutter next to an individual line, or from the “Breakpoints” section of the debug sidebar.</p></li><li><p>Click on the gutter next to the line that reads the current temp from your device. When a breakpoint is set, a red circle will appear next to the line on which to break.</p></li><li><p>Since you set your first breakpoint inside of the <code>loop</code>, it will be hit automatically after the interval period passes. You'll know that execution is paused because the line you set a breakpoint on will be highlighted in yellow and an arrow will appear in the gutter next to that line.</p></li></ol><p><img src="/assets/img/break.ddb8da72.png" alt></p><ol start="4"><li>Once a breakpoint is hit, the line in question will be highlighted in yellow. From here, you can use the Debug menu at the top of the screen to step through your code. From left to right in the image below, those buttons allow you to continue, step over the current line, step into the current line, step out of the current scope, restart the debug session (you’ll need to put the device back in DFU mode for this to work) and finally, to disconnect the session.</li></ol><p><img src="data:image/png;base64,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" alt></p><ol start="5"><li><p>Press the continue button. Your project will resume execution and break again on teh same line after the interval delay elapses.</p></li><li><p>It's also possible to only break code when a condition you define is met. Start by setting another breakpoint a few lines later on the <code>createEventPayload</code> line.</p></li><li><p>Right click on the gutter next to that line and select the &quot;Add conditional breakpoint&quot; option.</p></li><li><p>In the expression window that expands under the line you selected, you can enter a simple expression to evaluate each time this line is reached. When the expression evaluates to true, the breakpoint will halt execution. Otherwise, execution will continue as normal. Enter the expression <code>temp &gt; 68</code> and hit Enter.</p></li></ol><p><img src="/assets/img/conditional.8fa02799.png" alt></p><ol start="9"><li>Hit the continue button again. This time, execution will stop on your conditional breakpoint. Try changing the conditional value to <code>temp &gt; 90</code> and hit the continue button again. Observe that, this time, the breakpoint is not hit.</li></ol><h4 id="inspecting-variables"><a href="#inspecting-variables" aria-hidden="true" class="header-anchor">#</a> Inspecting variables</h4><p>In addition to step-debugging to inspect the execution of our apps, we often want to inspect the state of certain variables and objects. Workbench provides two ways to do this: Either by hovering over a variable in the code window, or by viewing variables in the &quot;Variables&quot; panel of the debug sidebar.</p><ol><li><p>While debugging and paused on any line, hover your mouse over the <code>currentLightLevel</code> variable. A tooltip will appear showing the current value of the variable.</p></li><li><p>To view all variables, expand the &quot;Variables&quot; panel of the debug sidebar. This panel shows information about all local, global and static variables currently in scope at the point of execution.</p></li></ol><p><img src="/assets/img/variablessidebar.6772365f.png" alt></p><h4 id="watching-variable-values"><a href="#watching-variable-values" aria-hidden="true" class="header-anchor">#</a> Watching variable values</h4><p>Beyond inspecting local and global variables, you can use the watch panel to tell the debugger to keep track of the state of a given variable or object. This can be quite useful if you want to see how a portion of your application mutates or is affected by another variable, or if you want to take a closer look at when a given variable or object comes into or goes out of scope as your app is running.</p><ol><li>To watch a variable, expand the &quot;Watch&quot; panel of the debug sidebar. Click the &quot;+&quot; symbol, and add <code>jw</code> in the expression box.</li></ol><p><img src="/assets/img/jw.85877177.png" alt></p><ol start="2"><li>Now, add a breakpoint to the first line in the <code>createEventPayload</code> function, which creates the <code>JsonWriterStatic</code> object.</li></ol><p><img src="/assets/img/jwbreakpoint.abd367b6.png" alt></p><ol start="3"><li><p>Start (or continue) debugging until you reach the breakpoint you just set. Hit the step-over icon (second from the left) and watch how the <code>jw</code> value in the Watch window changes.</p></li><li><p>Hit the step-over icon a few more times until you reach the end of the <code>createEventPayload</code> function, and observe how the Watch value changes.</p></li></ol><h4 id="navigating-the-call-stack"><a href="#navigating-the-call-stack" aria-hidden="true" class="header-anchor">#</a> Navigating the call stack</h4><p>Finally, let's look at using the debugger to navigate the call stack.</p><ol><li>Start by adding the breakpoint to the first line of the <code>toggleLed</code> function. If you've stopped debugging, restart and continue until your device is breathing cyan.</li></ol><p><img src="/assets/img/callstackbreakpoint.9868b69e.png" alt></p><ol start="2"><li><p>Open the console and call the <code>toggleLed</code> Cloud function using the <code>Call</code> button on  your device dashboard screen. The breakpoint you set on the <code>toggleLed</code> function will be hit shortly after you call the function.</p></li><li><p>Expand the &quot;Call Stack&quot; panel of the Debug sidebar. This view shows you the entire call stack for your application, from the Device OS logic that handled calling your function, all the way up to the main program loop. You can click on any item in the stack list to view the source and current execution location of the program.</p></li></ol><p><img src="/assets/img/incallstack.90020076.png" alt></p><h4 id="advanced-debugging-features"><a href="#advanced-debugging-features" aria-hidden="true" class="header-anchor">#</a> Advanced debugging features</h4><p>In addition to the features covered in this lab, the Workbench debugger provides access to several debug features built-in to VS Code and leveraged by the cortex-debug extension, including the ability to inspect and edit hardware registers, peripherals, and even direct memory locations. All of these are outside of the scope of this workshop, so <a href="https://code.visualstudio.com/docs/editor/debugging" target="_blank" rel="noopener noreferrer">check out the docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for these tools to learn more about how to use them.</p><h3 id="stepping-out-of-the-debug-cycle"><a href="#stepping-out-of-the-debug-cycle" aria-hidden="true" class="header-anchor">#</a> Stepping out of the debug cycle</h3><p>Once you’re done debugging and ready to resume normal coding and flashing, you’ll need to get your device out of its debug state, meaning that you want to replace the “monolithic” debug build with the hybrid application and device OS firmware. To do this, put the device back into DFU mode and run the <code>Particle: Flash application &amp; DeviceOS (local)</code> command in the Workbench command palette.</p><p>And if you ever run into weird errors while debugging or flashing, the Workbench clean commands are your friends! In our experience, when these things pop up, running <code>Particle: Clean application &amp; DeviceOS (local)</code> and <code>Particle: Clean application for debug (local)</code> are usually enough to set things right again.</p><hr><p><strong>Congratulations! You've completed this workshop. Now you're a Particle Master! Take a moment to pat yourself on the back and bask in your newfound IoT-commandery. And if you want to take your exploration further, click the &quot;Extra&quot; link below!</strong></p><p><strong>BEFORE YOU GO</strong> you'd love it if you could provide feedback on this workshop. Please visit <a href="https://particleiot.typeform.com/to/JiF8xM" target="_blank" rel="noopener noreferrer">this link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to rate your experience.</p></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/particle-iot/roadshow-workshop-2019/edit/master/content/docs/ch3.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/ch2.html" class="prev">
          Chapter 2: Working with Particle Workbench, primitives &amp; BLE
        </a></span><span class="next"><a href="/docs/extra.html">
          Extra: Going Even Further!
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/1.b85082d9.js" defer></script><script src="/assets/js/app.7315a9e1.js" defer></script>
  </body>
</html>
